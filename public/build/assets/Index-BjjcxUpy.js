import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-DRIS-KGk.js";import{d as N,k as a,c as O,o as P,a as r,u as q,m as B,w as V,b as F,F as E,s as R}from"./app-DP6Rzc-B.js";import{_ as T}from"./Alert.vue_vue_type_script_setup_true_lang-CFl6qOps.js";import{_ as J}from"./DinnersTable.vue_vue_type_script_setup_true_lang-vfroRR5f.js";import{_ as j}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-Bb2K1oLK.js";import{_ as z}from"./SalesCard.vue_vue_type_script_setup_true_lang-CcUctXbn.js";import{_ as G}from"./SalesHeader.vue_vue_type_script_setup_true_lang-CYko4rxq.js";import{_ as K}from"./SalesTable.vue_vue_type_script_setup_true_lang-CSqSbk8r.js";import"./utils-bRKmu4jq.js";import"./index-CcEa8fad.js";import"./useForwardPropsEmits-B6Ggofp_.js";import"./Primitive-CEc2e5l3.js";import"./useForwardExpose-Ddxpw_-r.js";import"./useFocusGuards-KDbyjJZk.js";import"./Teleport-CapDL4Aj.js";import"./VisuallyHidden-N7AJoghk.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-aaOB-tcY.js";import"./Collection-BU9pKYmS.js";import"./usePrimitiveElement-Ci1vha5U.js";import"./utils-qfjUvLWn.js";import"./useTypeahead-DqjwZD9y.js";import"./RovingFocusGroup-Ip9XIC2z.js";import"./createLucideIcon-cztl0L4-.js";import"./x-CuZK-L1L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./building-2-BzB5jvl7.js";import"./user-JitnrCF0.js";import"./chevron-right-DcqPXQja.js";import"./index-BbaUfmu4.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BAGvukS9.js";import"./nullish-CHIgUVhi.js";import"./check-YHJ4oenR.js";import"./RovingFocusItem-BXxLY7j-.js";import"./Input.vue_vue_type_script_setup_true_lang-C1R2EPX6.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-D79uiJOY.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-AXdHGWO8.js";import"./Card.vue_vue_type_script_setup_true_lang-ChpHV3Py.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-Bg-jETYW.js";import"./chevron-down-DMDgYHj_.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-C-z4T3XV.js";import"./chevron-left-DAvlC99k.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-DiIbnqpH.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-B7Qp_SjL.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-d1jti44B.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-tcsexEnX.js";import"./PricesDialog.vue_vue_type_script_setup_true_lang-DA_aHey0.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-CDXatqM_.js";import"./loader-circle-DmJ60-Pg.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-a78lFVgg.js";import"./TableCell.vue_vue_type_script_setup_true_lang-BzsZlEuZ.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-FG32MdC3.js";const L={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},M={class:"grid auto-rows-min gap-4 md:grid-cols-2"},Me=N({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},sales:{}},setup(Q){const n=a(null),s=a([]),b=e=>s.value.some(t=>t.serviceID===e.id),A=e=>{if(b(e)){s.value=s.value.filter(t=>t.serviceID!==e.id);return}s.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},C=e=>{u.value=e},u=a([]),v=a(!1),f=a(""),_=a(""),h=a(""),l=a(!1),p=a(!1),c=(e,t)=>{var o;f.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",_.value=e,v.value=!0},S=()=>{l.value=!0},U=()=>{l.value=!1,p.value=!1},I=e=>{h.value=e},$=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI vÃ¡lido.");return}else m(e)},y=a(0),g=a(0),D=a(0),x=e=>{y.value=e.cafe_id,g.value=e.sale_type_id,D.value=e.receipt_type_id},k=e=>{var t;p.value=!0,m((t=d.value)==null?void 0:t.dni)},d=a({}),w=a({}),m=e=>{const t=new FormData;t.append("cafe_id",y.value),t.append("sale_type_id",g.value),t.append("receipt_type",D.value),t.append("services",JSON.stringify(s.value)),t.append("dni",e),t.append("date",h.value),t.append("double_price",p.value),R.post("./sales",t).then(o=>{var i;o.data.dinner&&(d.value=o.data.dinner,w.value=o.data.dinner.subdealership,c("success",o.data.message||"Venta registrada exitosamente."),(i=n.value)==null||i.cleanInput()),o.data.otherCafe&&S()}).catch(o=>{var i;console.error("Error fetching dinners:",o),c("error",o),(i=n.value)==null||i.cleanInput()})};return(e,t)=>(P(),O(E,null,[r(q(B),{title:"Comensales"}),r(H,null,{default:V(()=>[r(T,{showAlert:v.value,type:_.value,description:f.value},null,8,["showAlert","type","description"]),F("div",L,[r(G,{cafes:e.cafes,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:C,onUpdateDate:I,onUpdateFormData:x},null,8,["cafes","services","receipt_types","sale_types"]),F("div",M,[r(z,{dinnerFound:d.value,subdealership:w.value,onHandleShowAlert:c,onShowDialog:S,onSaveSale:m,onUpdateDni:$,ref_key:"salesCardRef",ref:n},null,8,["dinnerFound","subdealership"]),r(J,{dinners:e.dinners,services:u.value,onAddServiceSelected:A},null,8,["dinners","services"]),r(K,{sales:e.sales},null,8,["sales"]),r(j,{showOtherUnitDialog:l.value,onHideDialog:U,onHandleDoublePriceSave:k},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{Me as default};
