import{_ as F}from"./index-Cssfem1N.js";import{_ as P,a as V,b as z,c as M}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DA8G7DBa.js";import{_ as N}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BYj5aJt3.js";import{_ as A}from"./DialogFooter.vue_vue_type_script_setup_true_lang-B64sSsYp.js";import{_ as O}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-BLbnlLq5.js";import{c as q,_ as L,a as I,b as h}from"./TabsTrigger.vue_vue_type_script_setup_true_lang-bZRpXGG8.js";import{_ as G}from"./AlertErrors.vue_vue_type_script_setup_true_lang-nVb6fKQj.js";import{j as u,C as Z,d as W,g as y,o as S,w as t,a as l,u as e,e as d,b as $,i as X}from"./app-9tqjBHEs.js";import{_ as H}from"./AttachmentsTab.vue_vue_type_script_setup_true_lang-DKSZ1C3T.js";import{_ as J}from"./FinancialDataTab.vue_vue_type_script_setup_true_lang-BNAsGZXc.js";import{_ as K}from"./PersonalDataTab.vue_vue_type_script_setup_true_lang-RgEyYOWf.js";import{_ as Q}from"./SizesTab.vue_vue_type_script_setup_true_lang-Bpnm53ho.js";const Y=9*1024*1024;function ee(){const s=u(!1),i=u(""),o=u([{label:"CV Documentado",file:{}},{label:"Certificado Único Laboral (CUL)",file:{},expirationDate:null},{label:"Certificado de Estudios",file:{}},{label:"Certificados de Trabajo",file:{}},{label:"DNI escaneado",file:{},expirationDate:null},{label:"Antecedentes Penales y Policiales",file:{},expirationDate:null},{label:"Carné de sanidad",file:{},expirationDate:null},{label:"Carné de vacunación contra el COVID",file:{}},{label:"Examen Medico Ocupacional (EMO)",file:{},expirationDate:null},{label:"SCTR",file:{},expirationDate:null},{label:"Contrato",file:{},expirationDate:null}]);return{filesRequired:o,showAlert:s,alertMessage:i,handleFileUpload:(v,p,f)=>{const r=v.target.files;if(r.length>0){const n=r[0];if(n.size>Y)i.value="El archivo es demasiado grande. El máximo es 9MB.",s.value=!0;else if(o.value.find(g=>g.label==p)){const b=n.name.split(".").pop(),x=new File([n],`${p}_${Date.now()}.${b}`,{type:n.type});f.push({file:x,label:p})}}}}}function ae(){const s=u(null),i=u(null),o=u(null);return{fileInput:s,imagePreview:i,selectedFile:o,triggerFileInput:()=>{var f;(f=s.value)==null||f.click()},handleImageUpload:f=>{var _;const n=(_=f.target.files)==null?void 0:_[0];if(n){if(!n.type.startsWith("image/")){alert("Por favor, selecciona solo archivos de imagen");return}const g=5*1024*1024;if(n.size>g){alert("La imagen es demasiado grande. Máximo 5MB");return}o.value=n;const b=new FileReader;b.onload=x=>{var w;i.value=(w=x.target)==null?void 0:w.result},b.readAsDataURL(n)}},removeImage:()=>{i.value=null,o.value=null,s.value&&(s.value.value="")}}}function le(){const s=Z({name:"",dni:"",cell:"",birthdate:"",age:0,sex:0,email:"",country:"",civilstatus:0,contactname:"",contactcell:"",cafeId:null,files:[],tipoContrato:"",regimenLaboral:"",fechaIngreso:"",fechaFinContract:"",cc:"",cci:"",children:0,prendas:[],district:"",province:"",department:"",afp:"",onp:"",position:"",address:"",workSystem:"",replacement:"",unitId:0,salary:0,observations:"",fondo:0,roleId:null,unitSelectedText:""}),i=u([]),o=u(!1),m=u([{label:"Polo",talla:""},{label:"Cafarena",talla:""},{label:"Overall",talla:""},{label:"Casaca",talla:""},{label:"Chaleco",talla:""},{label:"Chaqueta Blanca",talla:""},{label:"Pantalón",talla:""},{label:"Camisa/Blusa",talla:""},{label:"Guardapolvo",talla:""},{label:"Guantes",talla:""},{label:"Botas Blancas",talla:""},{label:"Zapatos",talla:""},{label:"Lentes",talla:""}]);return{form:s,errorsSend:i,showErrors:o,prendasFijas:m,handleSubmit:r=>{s.prendas=m.value,s.post(route("staff.store"),{onSuccess:n=>{s.reset(),r()},onError:n=>{o.value=!0,i.value=n,console.error("Error al subir el archivo:",n)}})},selectCafe:r=>{s.cafeId=r.id,s.unitId=r.unit_id,s.unitSelectedText=r.unit.name},selectRole:r=>{s.roleId=r.id}}}const te={class:"flex-1 overflow-y-auto bg-gray-50/50 px-6 py-4"},be=W({__name:"StaffRegistrationDialog",props:{cafes:{},roles:{}},setup(s){const i=u(!1),o=u("personal"),{form:m,errorsSend:v,showErrors:p,prendasFijas:f,handleSubmit:r,selectCafe:n,selectRole:_}=le(),{fileInput:g,imagePreview:b,triggerFileInput:x,handleImageUpload:w,removeImage:R}=ae(),{filesRequired:D,showAlert:k,alertMessage:E,handleFileUpload:U}=ee(),T=()=>{const c=["personal","adjuntos","financiero","tallas"],a=c.indexOf(o.value);a<c.length-1&&(o.value=c[a+1])},j=()=>{const c=["personal","adjuntos","financiero","tallas"],a=c.indexOf(o.value);a>0&&(o.value=c[a-1])},B=()=>{r(()=>{i.value=!1,o.value="personal"})};return(c,a)=>(S(),y(e(M),{open:i.value,"onUpdate:open":a[2]||(a[2]=C=>i.value=C)},{default:t(()=>[l(e(O),{"as-child":""},{default:t(()=>[l(e(F),{variant:"default",class:"cursor-pointer bg-blue-600 text-white hover:bg-blue-700"},{default:t(()=>a[3]||(a[3]=[d(" Nuevo Personal ")])),_:1})]),_:1}),l(e(P),{class:"flex h-[90vh] flex-col gap-0 overflow-hidden p-0 sm:max-w-5xl"},{default:t(()=>[$("input",{type:"file",ref_key:"fileInput",ref:g,onChange:a[0]||(a[0]=(...C)=>e(w)&&e(w)(...C)),accept:"image/*",class:"hidden"},null,544),l(e(V),{class:"z-10 border-b bg-white px-6 py-4"},{default:t(()=>[l(e(z),{class:"text-xl font-bold text-zinc-800 md:text-2xl"},{default:t(()=>a[4]||(a[4]=[d(" Ficha de Registro de Colaborador ")])),_:1}),l(e(N),null,{default:t(()=>a[5]||(a[5]=[d(" Complete los datos del proceso de alta en las secciones a continuación. ")])),_:1}),l(G,{show:e(p),errors:e(v)},null,8,["show","errors"])]),_:1}),$("div",te,[l(e(q),{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=C=>o.value=C),class:"w-full"},{default:t(()=>[l(e(L),{class:"mb-6 grid w-full grid-cols-4 bg-zinc-100 p-1"},{default:t(()=>[l(e(I),{value:"personal",class:"text-xs md:text-sm"},{default:t(()=>a[6]||(a[6]=[d("1. Personal")])),_:1}),l(e(I),{value:"adjuntos",class:"text-xs md:text-sm"},{default:t(()=>a[7]||(a[7]=[d("2. Adjuntos")])),_:1}),l(e(I),{value:"financiero",class:"text-xs md:text-sm"},{default:t(()=>a[8]||(a[8]=[d("3. Financiero")])),_:1}),l(e(I),{value:"tallas",class:"text-xs md:text-sm"},{default:t(()=>a[9]||(a[9]=[d("4. Tallas")])),_:1})]),_:1}),l(e(h),{value:"personal",class:"mt-0"},{default:t(()=>[l(K,{form:e(m),cafes:c.cafes,"image-preview":e(b),onTriggerUpload:e(x),onRemoveImage:e(R),onSelectCafe:e(n)},null,8,["form","cafes","image-preview","onTriggerUpload","onRemoveImage","onSelectCafe"])]),_:1}),l(e(h),{value:"adjuntos",class:"mt-0"},{default:t(()=>[l(H,{"files-required":e(D),"show-alert":e(k),"alert-message":e(E),form:e(m),onUploadFile:e(U)},null,8,["files-required","show-alert","alert-message","form","onUploadFile"])]),_:1}),l(e(h),{value:"financiero",class:"mt-0"},{default:t(()=>[l(J,{form:e(m),roles:c.roles,onSelectRole:e(_),onUploadFile:e(U)},null,8,["form","roles","onSelectRole","onUploadFile"])]),_:1}),l(e(h),{value:"tallas",class:"mt-0"},{default:t(()=>[l(Q,{prendas:e(f)},null,8,["prendas"])]),_:1})]),_:1},8,["modelValue"])]),l(e(A),{class:"z-10 flex w-full flex-row items-center justify-between border-t bg-white px-6 py-4"},{default:t(()=>[$("div",null,[o.value!=="personal"?(S(),y(e(F),{key:0,onClick:j,variant:"outline",type:"button"},{default:t(()=>a[10]||(a[10]=[d(" ← Anterior ")])),_:1})):X("",!0)]),$("div",null,[o.value!=="tallas"?(S(),y(e(F),{key:0,onClick:T,type:"button",class:"bg-blue-600 text-white hover:bg-blue-700"},{default:t(()=>a[11]||(a[11]=[d(" Siguiente → ")])),_:1})):(S(),y(e(F),{key:1,onClick:B,type:"button",class:"bg-green-600 text-white hover:bg-green-700"},{default:t(()=>a[12]||(a[12]=[d(" Finalizar Registro ")])),_:1}))])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{be as _};
