import{d as z,k as p,b$ as E,D as O,u as g,o as l,c,a as V,i as B,b as L,Y as T,bQ as F,F as H,l as I,t as P,v as S,V as $,s as q}from"./app-KfXT5fzK.js";import A from"./Draggable-CyAn4M7N.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-CGcKhtYp.js";import"./createLucideIcon-ADMu23uL.js";var k={exports:{}},R;function K(){return R||(R=1,function(m,b){function v(e){return typeof e.value!="function"?(console.warn("[Vue-click-outside:] provided expression",e.expression,"is not a function."),!1):!0}function d(e,t){if(!e||!t)return!1;for(var r=0,a=t.length;r<a;r++)try{if(e.contains(t[r]))return!0;if(t[r].contains(e))return!1}catch{return!1}return!1}function s(e){return typeof e.componentInstance<"u"&&e.componentInstance.$isServer}m.exports={bind:function(e,t,r){if(!v(t))return;function a(u){if(r.context){var f=u.path||u.composedPath&&u.composedPath();f&&f.length>0&&f.unshift(u.target),!(e.contains(u.target)||d(r.context.popupItem,f))&&e.__vueClickOutside__.callback(u)}}e.__vueClickOutside__={handler:a,callback:t.value};const _="ontouchstart"in document.documentElement?"touchstart":"click";!s(r)&&document.addEventListener(_,a)},update:function(e,t){v(t)&&(e.__vueClickOutside__.callback=t.value)},unbind:function(e,t,r){const a="ontouchstart"in document.documentElement?"touchstart":"click";!s(r)&&e.__vueClickOutside__&&document.removeEventListener(a,e.__vueClickOutside__.handler),delete e.__vueClickOutside__}}}(k)),k.exports}var M=K();const N={key:0},Q={key:1},Y={key:0,class:"relative"},j={key:0,class:"absolute z-10 mt-1 w-full rounded border border-zinc-300 bg-white shadow-lg"},J=["onClick"],W={key:1,class:"p-2 text-sm text-zinc-500"},X=z({__name:"GuardRolesDropzone",props:{role:{},users:{}},emits:["roleAssigned","unassignUser"],setup(m,{emit:b}){var y;const v=b,d=m,s=p(null),e=p(!1),t=p(""),r=p([]),a=p(null);(y=d.role)!=null&&y.user&&(s.value=d.role.user);const _=n=>{s.value=null,v("unassignUser",n)},u=n=>{s.value=n,e.value=!1,t.value="",r.value=[],q.post("/guard-roles-user",{user_id:n.id,guard_role_id:d.role.id}).then(i=>{v("roleAssigned",n.id)}).catch(i=>{var o;console.error("Error al asignar el rol:",i),s.value=(o=d.role)!=null&&o.user?d.role.user:null})},f=async()=>{if(t.value.length<3){r.value=[];return}const n=d.users;r.value=n.filter(i=>i.name.toLowerCase().includes(t.value.toLowerCase())).slice(0,5)},w=()=>{s.value||(e.value=!0,$(()=>{a.value&&a.value.focus()}))},x=()=>{e.value=!1,t.value="",r.value=[]},D=n=>{u(n)},{elementRef:U,isOvered:C}=E({events:{onDrop:(n,i)=>{var h;const o=(h=i.items[0].data)==null?void 0:h.user;o&&u(o)}}});return(n,i)=>O((l(),c("div",{ref_key:"guardRolesDropzoneRef",ref:U,class:"relative min-h-[6rem] w-full"},[s.value&&s.value.id?(l(),c("div",N,[V(A,{user:s.value,onUnassignUser:_,showButtonDelete:!0},null,8,["user"])])):(l(),c("div",Q,[e.value?(l(),c("div",Y,[O(L("input",{type:"text","onUpdate:modelValue":i[0]||(i[0]=o=>t.value=o),onInput:f,placeholder:"Buscar y asignar usuario...",class:"w-full rounded border border-blue-500 p-2 focus:ring-2 focus:ring-blue-500",onKeyup:T(x,["esc"]),ref_key:"inputRef",ref:a},null,544),[[F,t.value]]),r.value.length?(l(),c("ul",j,[(l(!0),c(H,null,I(r.value,o=>(l(),c("li",{key:o.id,onClick:h=>D(o),class:"cursor-pointer p-2 hover:bg-blue-100"},P(o.name),9,J))),128))])):t.value.length>=3?(l(),c("div",W,"No se encontraron usuarios.")):B("",!0)])):(l(),c("div",{key:1,onClick:w,class:S({"cursor-pointer rounded border-2 border-dashed p-5 transition-colors":!0,"border-zinc-600":!g(C),"border-green-500 bg-green-50 dark:bg-zinc-800":g(C)})}," Haga clic o arrastre para asignar ",2))]))])),[[g(M.ClickOutside),x]])}}),ne=G(X,[["__scopeId","data-v-74747813"]]);export{ne as default};
