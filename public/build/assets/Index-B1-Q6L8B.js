import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-IcCGOgoO.js";import{d as N,l as a,c as O,o as k,a as o,u as q,m as B,w as H,b as w,F as V,s as E}from"./app-D_QSpg_R.js";import{_ as P}from"./Alert.vue_vue_type_script_setup_true_lang-WyXBxl4f.js";import{_ as R}from"./DinnersTable.vue_vue_type_script_setup_true_lang-BqtYAWSe.js";import{_ as T}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-qS8oO2dP.js";import{_ as J}from"./SalesCard.vue_vue_type_script_setup_true_lang-FNDBEOle.js";import{_ as j}from"./SalesHeader.vue_vue_type_script_setup_true_lang-WOOBUpRB.js";import{_ as z}from"./SalesTable.vue_vue_type_script_setup_true_lang-CHAZRyQi.js";import"./utils-bRKmu4jq.js";import"./index-ByDze7ZP.js";import"./useForwardPropsEmits-B_fT_aFN.js";import"./Primitive-BHXl7ujF.js";import"./useForwardExpose-YjIkJv8_.js";import"./useFocusGuards-UR9ZR3lF.js";import"./Teleport-CZ-98Igv.js";import"./VisuallyHidden-uK3rDYN0.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-C9C31HAu.js";import"./Collection-CqpPxiDW.js";import"./usePrimitiveElement-y0lN-vAh.js";import"./utils-gqKFNPsk.js";import"./useTypeahead-C02yOKj6.js";import"./RovingFocusGroup-DAZ1P44c.js";import"./createLucideIcon-B5-xWJ18.js";import"./x-BbOFuqaT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./building-2-BO5ds05r.js";import"./user-CEtnLBVn.js";import"./chevron-right-DYvQ5K5E.js";import"./index-BoyyQgqJ.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CiiUFhZ8.js";import"./nullish-CHIgUVhi.js";import"./check-BiFCcv32.js";import"./RovingFocusItem-CDi1zKBP.js";import"./Input.vue_vue_type_script_setup_true_lang-DfRT2rYf.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-vsuVUd18.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-Bf_kw3gU.js";import"./Card.vue_vue_type_script_setup_true_lang-BpKYZXJk.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CsU7IuWm.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-CEOECRq5.js";import"./chevron-left-M-GyA2FQ.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-BKfGZsau.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BZ0YeGJL.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-CGBklnVV.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang--PT4M8s-.js";import"./PricesDialog.vue_vue_type_script_setup_true_lang-BKrixnBb.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-Dte4K-Ol.js";import"./TableCell.vue_vue_type_script_setup_true_lang-C26xBvNW.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-wti2Oj-M.js";const G={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},K={class:"grid auto-rows-min gap-4 md:grid-cols-2"},je=N({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},sales:{}},setup(L){const D=a(null),r=a([]),F=e=>r.value.some(t=>t.serviceID===e.id),A=e=>{if(F(e)){r.value=r.value.filter(t=>t.serviceID!==e.id);return}r.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},C=e=>{n.value=e},n=a([]),p=a(!1),c=a(""),d=a(""),m=a(""),i=a(!1),u=a(!1),l=(e,t)=>{var s;c.value=((s=t.response)==null?void 0:s.data.message)||t||"Ha ocurrido un error inesperado.",d.value=e,p.value=!0},f=()=>{i.value=!0},U=()=>{i.value=!1,u.value=!1},b=e=>{m.value=e},$=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI vÃ¡lido.");return}else g(e)},v=a(0),_=a(0),h=a(0),x=e=>{v.value=e.cafe_id,_.value=e.sale_type_id,h.value=e.receipt_type_id},y=a({}),S=a({}),g=e=>{const t=new FormData;t.append("cafe_id",v.value),t.append("sale_type_id",_.value),t.append("receipt_type",h.value),t.append("services",JSON.stringify(r.value)),t.append("dni",e),t.append("date",m.value),t.append("double_price",u.value),E.post("./sales",t).then(s=>{s.data.dinner&&(y.value=s.data.dinner,S.value=s.data.dinner.subdealership,l("success",s.data.message||"Venta registrada exitosamente."),e.value=""),s.data.otherCafe&&f()}).catch(s=>{console.error("Error fetching dinners:",s),l("error",s),e.value=""})};return(e,t)=>(k(),O(V,null,[o(q(B),{title:"Comensales"}),o(I,null,{default:H(()=>[o(P,{showAlert:p.value,type:d.value,description:c.value},null,8,["showAlert","type","description"]),w("div",G,[o(j,{cafes:e.cafes,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:C,onUpdateDate:b,onUpdateFormData:x},null,8,["cafes","services","receipt_types","sale_types"]),w("div",K,[o(J,{dinnerFound:y.value,subdealership:S.value,onHandleShowAlert:l,onShowDialog:f,onSaveSale:g,onUpdateDni:$,ref_key:"salesCardRef",ref:D},null,8,["dinnerFound","subdealership"]),o(R,{dinners:e.dinners,services:n.value,onAddServiceSelected:A},null,8,["dinners","services"]),o(z,{sales:e.sales},null,8,["sales"]),o(T,{showOtherUnitDialog:i.value,onHideDialog:U},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{je as default};
