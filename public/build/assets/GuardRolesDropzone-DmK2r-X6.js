import{d as z,j as p,b$ as E,D as O,u as h,o as i,c,a as V,i as B,b as L,Y as T,bQ as F,F as H,p as I,t as P,n as S,V as $,v as q}from"./app-QwgLVkVf.js";import A from"./Draggable-IcBDmO0J.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-DyJjjeXz.js";import"./createLucideIcon-BiidfG4i.js";var k={exports:{}},R;function K(){return R||(R=1,function(m,b){function v(e){return typeof e.value!="function"?(console.warn("[Vue-click-outside:] provided expression",e.expression,"is not a function."),!1):!0}function d(e,s){if(!e||!s)return!1;for(var t=0,a=s.length;t<a;t++)try{if(e.contains(s[t]))return!0;if(s[t].contains(e))return!1}catch{return!1}return!1}function n(e){return typeof e.componentInstance<"u"&&e.componentInstance.$isServer}m.exports={bind:function(e,s,t){if(!v(s))return;function a(u){if(t.context){var f=u.path||u.composedPath&&u.composedPath();f&&f.length>0&&f.unshift(u.target),!(e.contains(u.target)||d(t.context.popupItem,f))&&e.__vueClickOutside__.callback(u)}}e.__vueClickOutside__={handler:a,callback:s.value};const _="ontouchstart"in document.documentElement?"touchstart":"click";!n(t)&&document.addEventListener(_,a)},update:function(e,s){v(s)&&(e.__vueClickOutside__.callback=s.value)},unbind:function(e,s,t){const a="ontouchstart"in document.documentElement?"touchstart":"click";!n(t)&&e.__vueClickOutside__&&document.removeEventListener(a,e.__vueClickOutside__.handler),delete e.__vueClickOutside__}}}(k)),k.exports}var j=K();const M={key:0},N={key:1},Q={key:0,class:"relative"},Y={key:0,class:"absolute z-10 mt-1 w-full rounded border border-zinc-300 bg-white shadow-lg"},J=["onClick"],W={key:1,class:"p-2 text-sm text-zinc-500"},X=z({__name:"GuardRolesDropzone",props:{role:{},users:{}},emits:["roleAssigned","unassignUser"],setup(m,{emit:b}){var y;const v=b,d=m,n=p(null),e=p(!1),s=p(""),t=p([]),a=p(null);(y=d.role)!=null&&y.user&&(n.value=d.role.user);const _=o=>{n.value=null,v("unassignUser",o)},u=o=>{n.value=o,e.value=!1,s.value="",t.value=[],q.post("guards/roles/user",{user_id:o.id,guard_role_id:d.role.id}).then(l=>{v("roleAssigned",o.id)}).catch(l=>{var r;console.error("Error al asignar el rol:",l),n.value=(r=d.role)!=null&&r.user?d.role.user:null})},f=async()=>{if(s.value.length<3){t.value=[];return}const o=d.users;t.value=o.filter(l=>l.name.toLowerCase().includes(s.value.toLowerCase())).slice(0,5)},w=()=>{n.value||(e.value=!0,$(()=>{a.value&&a.value.focus()}))},x=()=>{e.value=!1,s.value="",t.value=[]},D=o=>{u(o)},{elementRef:U,isOvered:C}=E({events:{onDrop:(o,l)=>{var g;const r=(g=l.items[0].data)==null?void 0:g.user;console.log(r),r&&u(r)}}});return(o,l)=>O((i(),c("div",{ref_key:"guardRolesDropzoneRef",ref:U,class:"relative min-h-[6rem] w-full"},[n.value&&n.value.id?(i(),c("div",M,[V(A,{user:n.value,onUnassignUser:_,showButtonDelete:!0},null,8,["user"])])):(i(),c("div",N,[e.value?(i(),c("div",Q,[O(L("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=r=>s.value=r),onInput:f,placeholder:"Buscar y asignar usuario...",class:"w-full rounded border border-blue-500 p-2 focus:ring-2 focus:ring-blue-500",onKeyup:T(x,["esc"]),ref_key:"inputRef",ref:a},null,544),[[F,s.value]]),t.value.length?(i(),c("ul",Y,[(i(!0),c(H,null,I(t.value,r=>(i(),c("li",{key:r.id,onClick:g=>D(r),class:"cursor-pointer p-2 hover:bg-blue-100"},P(r.name),9,J))),128))])):s.value.length>=3?(i(),c("div",W,"No se encontraron usuarios.")):B("",!0)])):(i(),c("div",{key:1,onClick:w,class:S({"cursor-pointer rounded border-2 border-dashed p-5 transition-colors":!0,"border-zinc-600":!h(C),"border-green-500 bg-green-50 dark:bg-zinc-800":h(C)})}," Haga clic o arrastre para asignar ",2))]))])),[[h(j.ClickOutside),x]])}}),ne=G(X,[["__scopeId","data-v-ff18c7ec"]]);export{ne as default};
