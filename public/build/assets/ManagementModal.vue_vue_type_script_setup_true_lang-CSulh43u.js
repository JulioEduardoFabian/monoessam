import{_ as h}from"./index-1zKrS11E.js";import{_ as A,a as D,b as E,c as S,d as j}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-DkdBSBqw.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-wZEN1N3v.js";import{d as q,l as _,C as z,g as G,o,w as r,a as u,u as s,e as U,b as c,c as i,i as I,F as C,k as V,t as $,v as f}from"./app-DNKYuSpD.js";const H={class:"mb-4"},J={class:"flex gap-2"},K={key:0},O={key:1},P={key:0,class:"mt-1 max-h-40 overflow-auto rounded-md border"},Q=["onClick"],R={class:"mb-4"},W={class:"flex gap-2"},X={key:0},Y={key:1},Z={key:0,class:"mt-1 max-h-40 overflow-auto rounded-md border"},ee=["onClick"],te={class:"mb-4"},ae={class:"flex gap-2"},ne={key:0},se={key:1},le={key:0,class:"mt-1 max-h-40 overflow-auto rounded-md border"},oe=["onClick"],me=q({__name:"ManagementModal",setup(ie){const v=_([]),d=_([]),m=_([]),F=_(!1),l=_({mine:!1,unit:!1,cafe:!1}),e=z({mine:"",mineId:0,unit:"",unitId:0,cafe:"",cafeId:0}),b=g(()=>{if(e.mine.trim()===""){v.value=[];return}l.value.mine=!0,f.get("/search-mine/"+e.mine).then(a=>{v.value=a.data}).catch(console.error).finally(()=>l.value.mine=!1)},300),k=g(()=>{if(e.unit.trim()===""){d.value=[];return}l.value.unit=!0,f.get("/search-unit/"+e.unit).then(a=>{d.value=a.data}).catch(console.error).finally(()=>l.value.unit=!1)},300),y=g(()=>{if(e.cafe.trim()===""){m.value=[];return}l.value.cafe=!0,f.get("/search-cafe/"+e.cafe).then(a=>{m.value=a.data}).catch(console.error).finally(()=>l.value.cafe=!1)},300),B=()=>{e.mine.trim()!==""&&(l.value.mine=!0,f.post("/mines",{name:e.mine}).then(()=>{e.mineId=0,b()}).catch(console.error).finally(()=>l.value.mine=!1))},w=()=>{e.unit.trim()===""||e.mineId==0||(l.value.unit=!0,f.post("/units",{name:e.unit,mine_id:e.mineId}).then(()=>{e.unitId=0,k()}).catch(console.error).finally(()=>l.value.unit=!1))},M=()=>{e.cafe.trim()===""||e.unitId==0||(l.value.cafe=!0,f.post("/cafes",{name:e.cafe,unit_id:e.unitId}).then(()=>{e.cafeId=0,y()}).catch(console.error).finally(()=>l.value.cafe=!1))},N=a=>{e.mine=a.name,e.mineId=a.id,v.value=[],d.value=a.units},L=a=>{e.unit=a.name,e.unitId=a.id,d.value=[],m.value=a.cafes,console.log(a)},T=a=>{e.cafe=a.name,e.cafeId=a.id,m.value=[]};function g(a,n){let t;return function(...p){clearTimeout(t),t=setTimeout(()=>a.apply(null,p),n)}}return(a,n)=>(o(),G(s(j),{open:F.value,"onUpdate:open":n[3]||(n[3]=t=>F.value=t)},{default:r(()=>[u(s(A),{"as-child":""},{default:r(()=>[u(h,{variant:"outline"},{default:r(()=>n[4]||(n[4]=[U("Añadir Lugar")])),_:1})]),_:1}),u(s(D),{class:"max-w-md"},{default:r(()=>[u(s(E),null,{default:r(()=>[u(s(S),{class:"mb-4 text-lg font-semibold"},{default:r(()=>n[5]||(n[5]=[U("Agregar Nuevo Lugar")])),_:1}),c("div",H,[n[6]||(n[6]=c("label",{class:"mb-1 block text-sm font-medium"},"Mina",-1)),c("div",J,[u(x,{modelValue:s(e).mine,"onUpdate:modelValue":n[0]||(n[0]=t=>s(e).mine=t),type:"text",placeholder:"Buscar mina...",onInput:s(b),onFocus:s(b),class:"flex-1"},null,8,["modelValue","onInput","onFocus"]),u(h,{type:"button",onClick:B,disabled:!s(e).mine.trim()||l.value.mine},{default:r(()=>[l.value.mine?(o(),i("span",K,"...")):(o(),i("span",O,"+"))]),_:1},8,["disabled"])]),v.value.length>0?(o(),i("ul",P,[(o(!0),i(C,null,V(v.value,t=>(o(),i("li",{key:t.id,class:"cursor-pointer p-2 hover:bg-gray-100 hover:text-black",onClick:p=>N(t)},$(t.name),9,Q))),128))])):I("",!0)]),c("div",R,[n[7]||(n[7]=c("label",{class:"mb-1 block text-sm font-medium"},"Unidad",-1)),c("div",W,[u(x,{modelValue:s(e).unit,"onUpdate:modelValue":n[1]||(n[1]=t=>s(e).unit=t),type:"text",placeholder:"Buscar unidad...",onInput:s(k),onFocus:s(k),class:"flex-1"},null,8,["modelValue","onInput","onFocus"]),u(h,{type:"button",onClick:w,disabled:!s(e).unit.trim()||l.value.unit},{default:r(()=>[l.value.unit?(o(),i("span",X,"...")):(o(),i("span",Y,"+"))]),_:1},8,["disabled"])]),d.value.length>0?(o(),i("ul",Z,[(o(!0),i(C,null,V(d.value,t=>(o(),i("li",{key:t.id,class:"cursor-pointer p-2 hover:bg-gray-100 hover:text-black",onClick:p=>L(t)},$(t.name),9,ee))),128))])):I("",!0)]),c("div",te,[n[8]||(n[8]=c("label",{class:"mb-1 block text-sm font-medium"},"Cafetería",-1)),c("div",ae,[u(x,{modelValue:s(e).cafe,"onUpdate:modelValue":n[2]||(n[2]=t=>s(e).cafe=t),type:"text",placeholder:"Buscar cafetería...",onInput:s(y),onFocus:s(y),class:"flex-1"},null,8,["modelValue","onInput","onFocus"]),u(h,{type:"button",onClick:M,disabled:!s(e).cafe.trim()||l.value.cafe},{default:r(()=>[l.value.cafe?(o(),i("span",ne,"...")):(o(),i("span",se,"+"))]),_:1},8,["disabled"])]),m.value.length>0?(o(),i("ul",le,[(o(!0),i(C,null,V(m.value,t=>(o(),i("li",{key:t.id,class:"cursor-pointer p-2 hover:bg-gray-100 hover:text-black",onClick:p=>T(t)},$(t.name),9,oe))),128))])):I("",!0)])]),_:1})]),_:1})]),_:1},8,["open"]))}});export{me as _};
