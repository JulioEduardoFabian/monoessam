import{_ as N}from"./AppLayout.vue_vue_type_script_setup_true_lang-BwvwMCbd.js";import{d as O,l as a,c as P,o as k,a as r,u as q,m as B,w as V,b as F,F as E,s as R}from"./app-CSAmcM4-.js";import{_ as T}from"./Alert.vue_vue_type_script_setup_true_lang-B7g14Z8y.js";import{_ as J}from"./DinnersTable.vue_vue_type_script_setup_true_lang-t_cPVuVW.js";import{_ as j}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-UnsiSkOi.js";import{_ as z}from"./SalesCard.vue_vue_type_script_setup_true_lang-Q7FUFc8j.js";import{_ as G}from"./SalesHeader.vue_vue_type_script_setup_true_lang-CRgFkiIK.js";import{_ as K}from"./SalesTable.vue_vue_type_script_setup_true_lang-DkTE34x_.js";import"./utils-bRKmu4jq.js";import"./index-DyUhMhGA.js";import"./useForwardPropsEmits-BACIT-x0.js";import"./Primitive-Ydx7xRFx.js";import"./useForwardExpose-CZyHliBh.js";import"./useFocusGuards-CbL9h_US.js";import"./Teleport-BLVwYqFH.js";import"./VisuallyHidden-gdSemCtm.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-ByWTJ-7-.js";import"./Collection-B3vG1MmY.js";import"./usePrimitiveElement-deP2f5dF.js";import"./utils-CRcXqQup.js";import"./useTypeahead-NRnH4mGY.js";import"./RovingFocusGroup-Mkbvk5jg.js";import"./createLucideIcon-Bablt37P.js";import"./x-CNkLlm7o.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./building-2-DRVqjbDX.js";import"./user-CWizvzgL.js";import"./chevron-right-E97ZqZ2v.js";import"./index-BXbT6FZL.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-CAH1prpf.js";import"./nullish-CHIgUVhi.js";import"./check-mSrDMsxl.js";import"./RovingFocusItem-CRDeeZqx.js";import"./Input.vue_vue_type_script_setup_true_lang-B--MGpSa.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-CP-1hJjg.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-Dq7-4_Mo.js";import"./Card.vue_vue_type_script_setup_true_lang-MZbXKLpK.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-Bzwsclq_.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-CwGHlO2p.js";import"./chevron-left-Blf8rxhl.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-CA0gUvKz.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-BAqIESiS.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-CSRSZqU9.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-CjFS4LOm.js";import"./PricesDialog.vue_vue_type_script_setup_true_lang-BxwRQGek.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-DmoKRUvb.js";import"./loader-circle-B7of1RJm.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-Dp7-eY33.js";import"./TableCell.vue_vue_type_script_setup_true_lang-DCWTYW2s.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-DqkXjefw.js";const L={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},M={class:"grid auto-rows-min gap-4 md:grid-cols-2"},Le=O({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},sales:{}},setup(Q){const n=a(null),s=a([]),b=e=>s.value.some(t=>t.serviceID===e.id),A=e=>{if(b(e)){s.value=s.value.filter(t=>t.serviceID!==e.id);return}s.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},C=e=>{u.value=e},u=a([]),v=a(!1),f=a(""),_=a(""),h=a(""),l=a(!1),p=a(!1),c=(e,t)=>{var o;f.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",_.value=e,v.value=!0},S=()=>{l.value=!0},U=()=>{l.value=!1,p.value=!1},I=e=>{h.value=e},$=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI vÃ¡lido.");return}else m(e)},y=a(0),g=a(0),D=a(0),x=e=>{y.value=e.cafe_id,g.value=e.sale_type_id,D.value=e.receipt_type_id},H=e=>{var t;p.value=!0,m((t=d.value)==null?void 0:t.dni)},d=a({}),w=a({}),m=e=>{const t=new FormData;t.append("cafe_id",y.value),t.append("sale_type_id",g.value),t.append("receipt_type",D.value),t.append("services",JSON.stringify(s.value)),t.append("dni",e),t.append("date",h.value),t.append("double_price",p.value),R.post("./sales",t).then(o=>{var i;o.data.dinner&&(d.value=o.data.dinner,w.value=o.data.dinner.subdealership,c("success",o.data.message||"Venta registrada exitosamente."),(i=n.value)==null||i.cleanInput()),o.data.otherCafe&&S()}).catch(o=>{var i;console.error("Error fetching dinners:",o),c("error",o),(i=n.value)==null||i.cleanInput()})};return(e,t)=>(k(),P(E,null,[r(q(B),{title:"Comensales"}),r(N,null,{default:V(()=>[r(T,{showAlert:v.value,type:_.value,description:f.value},null,8,["showAlert","type","description"]),F("div",L,[r(G,{cafes:e.cafes,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:C,onUpdateDate:I,onUpdateFormData:x},null,8,["cafes","services","receipt_types","sale_types"]),F("div",M,[r(z,{dinnerFound:d.value,subdealership:w.value,onHandleShowAlert:c,onShowDialog:S,onSaveSale:m,onUpdateDni:$,ref_key:"salesCardRef",ref:n},null,8,["dinnerFound","subdealership"]),r(J,{dinners:e.dinners,services:u.value,onAddServiceSelected:A},null,8,["dinners","services"]),r(K,{sales:e.sales},null,8,["sales"]),r(j,{showOtherUnitDialog:l.value,onHideDialog:U,onHandleDoublePriceSave:H},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{Le as default};
