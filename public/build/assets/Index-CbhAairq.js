import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-De_Gwmq0.js";import{d as N,l as a,c as O,o as P,a as r,u as k,m as q,w as B,b as D,F as V,s as E}from"./app-DsJIaVU0.js";import{_ as R}from"./Alert.vue_vue_type_script_setup_true_lang-B9o_is7V.js";import{_ as T}from"./DinnersTable.vue_vue_type_script_setup_true_lang-DwkA9IA9.js";import{_ as J}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-j9JSKgxZ.js";import{_ as j}from"./SalesCard.vue_vue_type_script_setup_true_lang-CU6GCL0t.js";import{_ as z}from"./SalesHeader.vue_vue_type_script_setup_true_lang-K4Ps8kBO.js";import{_ as G}from"./SalesTable.vue_vue_type_script_setup_true_lang-CiH2ubey.js";import"./utils-bRKmu4jq.js";import"./index-K738Owa5.js";import"./useForwardPropsEmits-K0p1uxZ5.js";import"./Primitive-BSoiNcDk.js";import"./useForwardExpose-CfIc1jo1.js";import"./useFocusGuards-KNcae8hb.js";import"./Teleport-33bmYxll.js";import"./VisuallyHidden-BbShbV2X.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CsD4K55W.js";import"./Collection-DYUQChao.js";import"./usePrimitiveElement-DEZn1U63.js";import"./utils-_m4Q4Pg9.js";import"./useTypeahead-5F-Jth0a.js";import"./RovingFocusGroup-COys5SVJ.js";import"./createLucideIcon-CoTemy_E.js";import"./x-CoqJgX9P.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./building-2-EVx7z5y0.js";import"./user-CfUx6upH.js";import"./chevron-right-j2IFO-CT.js";import"./index-CUkxd34N.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DdxiRiRh.js";import"./nullish-CHIgUVhi.js";import"./check-lIQrHaEq.js";import"./RovingFocusItem-BjdLZrt9.js";import"./Input.vue_vue_type_script_setup_true_lang-CkUCauXp.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DHuET2Sm.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-Dxe4PoRO.js";import"./Card.vue_vue_type_script_setup_true_lang-CzKIWcJ1.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-Dcu2bjnq.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-DJABx11X.js";import"./chevron-left-B3-3AV57.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-Ccn49OPe.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-Dvyjszmx.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-DKafObc2.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-x733bcqE.js";import"./PricesDialog.vue_vue_type_script_setup_true_lang-CkSomO8s.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-C0YG33WJ.js";import"./loader-circle-B2-CZugk.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-DqOvcVfN.js";import"./TableCell.vue_vue_type_script_setup_true_lang-BHeLoDSN.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-BmLfKQT5.js";const K={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},L={class:"grid auto-rows-min gap-4 md:grid-cols-2"},Ke=N({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},sales:{}},setup(M){const w=a(null),s=a([]),F=e=>s.value.some(t=>t.serviceID===e.id),b=e=>{if(F(e)){s.value=s.value.filter(t=>t.serviceID!==e.id);return}s.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},A=e=>{c.value=e},c=a([]),m=a(!1),u=a(""),f=a(""),v=a(""),i=a(!1),n=a(!1),l=(e,t)=>{var o;u.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",f.value=e,m.value=!0},_=()=>{i.value=!0},C=()=>{i.value=!1,n.value=!1},U=e=>{v.value=e},$=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI vÃ¡lido.");return}else d(e)},h=a(0),S=a(0),y=a(0),x=e=>{h.value=e.cafe_id,S.value=e.sale_type_id,y.value=e.receipt_type_id},I=e=>{var t;n.value=!0,d((t=p.value)==null?void 0:t.dni)},p=a({}),g=a({}),d=e=>{const t=new FormData;t.append("cafe_id",h.value),t.append("sale_type_id",S.value),t.append("receipt_type",y.value),t.append("services",JSON.stringify(s.value)),t.append("dni",e),t.append("date",v.value),t.append("double_price",n.value),E.post("./sales",t).then(o=>{o.data.dinner&&(p.value=o.data.dinner,g.value=o.data.dinner.subdealership,l("success",o.data.message||"Venta registrada exitosamente.")),o.data.otherCafe&&_()}).catch(o=>{console.error("Error fetching dinners:",o),l("error",o)})};return(e,t)=>(P(),O(V,null,[r(k(q),{title:"Comensales"}),r(H,null,{default:B(()=>[r(R,{showAlert:m.value,type:f.value,description:u.value},null,8,["showAlert","type","description"]),D("div",K,[r(z,{cafes:e.cafes,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:A,onUpdateDate:U,onUpdateFormData:x},null,8,["cafes","services","receipt_types","sale_types"]),D("div",L,[r(j,{dinnerFound:p.value,subdealership:g.value,onHandleShowAlert:l,onShowDialog:_,onSaveSale:d,onUpdateDni:$,ref_key:"salesCardRef",ref:w},null,8,["dinnerFound","subdealership"]),r(T,{dinners:e.dinners,services:c.value,onAddServiceSelected:b},null,8,["dinners","services"]),r(G,{sales:e.sales},null,8,["sales"]),r(J,{showOtherUnitDialog:i.value,onHideDialog:C,onHandleDoublePriceSave:I},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{Ke as default};
