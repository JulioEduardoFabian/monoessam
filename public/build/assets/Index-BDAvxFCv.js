import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-CT7DtvzU.js";import{d as N,l as a,c as O,o as P,a as r,u as k,m as q,w as B,b as D,F as V,s as E}from"./app-DTnkyGMY.js";import{_ as R}from"./Alert.vue_vue_type_script_setup_true_lang-cMi1-157.js";import{_ as T}from"./DinnersTable.vue_vue_type_script_setup_true_lang-CY1Ftpt3.js";import{_ as J}from"./OtherUnitDialog.vue_vue_type_script_setup_true_lang-CA8fIiI6.js";import{_ as j}from"./SalesCard.vue_vue_type_script_setup_true_lang-CFQDTAWH.js";import{_ as z}from"./SalesHeader.vue_vue_type_script_setup_true_lang-DCIqr5bZ.js";import{_ as G}from"./SalesTable.vue_vue_type_script_setup_true_lang-BRrhSj9R.js";import"./utils-bRKmu4jq.js";import"./index-CjWTTpFz.js";import"./useForwardPropsEmits-3NXOzYuW.js";import"./Primitive-BzwOkT-8.js";import"./useForwardExpose-8PGoTI84.js";import"./useFocusGuards-Cfg_gncH.js";import"./Teleport-wQTUQ9yd.js";import"./VisuallyHidden-CpesrLdE.js";import"./index-dkW4UkYo.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CubgJTFe.js";import"./Collection-B5QLLZns.js";import"./usePrimitiveElement-CcA1TnYJ.js";import"./utils-DEl7RO3m.js";import"./useTypeahead-DzcBQcNT.js";import"./RovingFocusGroup-Bf_tDSN1.js";import"./createLucideIcon-BXuL7Zus.js";import"./x-DlbjKNi4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./building-2-yIYK0xFJ.js";import"./user-DrcNU036.js";import"./chevron-right-CnoqkSL7.js";import"./index-WSUxmKDE.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-DQJImWRD.js";import"./nullish-CHIgUVhi.js";import"./check-Dzu6YxPZ.js";import"./RovingFocusItem-BBQEZrAS.js";import"./Input.vue_vue_type_script_setup_true_lang-ckNUoNOQ.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-Ca97EHnU.js";import"./DialogFooter.vue_vue_type_script_setup_true_lang-Dlt1jN27.js";import"./Card.vue_vue_type_script_setup_true_lang-BgbhhQnz.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-CyuH_BuJ.js";import"./DatePicker.vue_vue_type_script_setup_true_lang-XlVcFJ3g.js";import"./chevron-left-CgUYkOjf.js";import"./CalendarPrevButton.vue_vue_type_script_setup_true_lang-jHzmRQv5.js";import"./PopoverTrigger.vue_vue_type_script_setup_true_lang-DCl5nzl1.js";import"./ExcelDialog.vue_vue_type_script_setup_true_lang-BgTxPCEn.js";import"./DialogTrigger.vue_vue_type_script_setup_true_lang-BsgItODS.js";import"./PricesDialog.vue_vue_type_script_setup_true_lang-D9U7flFk.js";import"./ReportDialog.vue_vue_type_script_setup_true_lang-BCrkDJwp.js";import"./loader-circle-CjiAbSmF.js";import"./TableHeader.vue_vue_type_script_setup_true_lang-C1lHobRo.js";import"./TableCell.vue_vue_type_script_setup_true_lang-OsTiHrEh.js";import"./SaleDetailsPopover.vue_vue_type_script_setup_true_lang-DyWQlNfo.js";const K={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},L={class:"grid auto-rows-min gap-4 md:grid-cols-2"},Ke=N({__name:"Index",props:{dinners:{},services:{},units:{},cafes:{},sale_types:{},receipt_types:{},sales:{}},setup(M){const w=a(null),s=a([]),F=e=>s.value.some(t=>t.serviceID===e.id),b=e=>{if(F(e)){s.value=s.value.filter(t=>t.serviceID!==e.id);return}s.value.push({serviceID:e.id,quantity:e.quantity||1,price:e.quantity*e.pivot.price,code:e.code,name:e.name,unit_price:e.pivot.price,service_type:e.type})},A=e=>{d.value=e},d=a([]),m=a(!1),u=a(""),v=a(""),f=a(""),i=a(!1),l=a(!1),n=(e,t)=>{var o;u.value=((o=t.response)==null?void 0:o.data.message)||t||"Ha ocurrido un error inesperado.",v.value=e,m.value=!0},_=()=>{i.value=!0},C=()=>{i.value=!1,l.value=!1},U=e=>{f.value=e},$=e=>{if(!e.trim()||e.length!=8){alert("Por favor, ingrese un DNI vÃ¡lido.");return}else c(e)},h=a(0),S=a(0),y=a(0),x=e=>{h.value=e.cafe_id,S.value=e.sale_type_id,y.value=e.receipt_type_id},I=e=>{var t;l.value=!0,c((t=p.value)==null?void 0:t.dni)},p=a({}),g=a({}),c=e=>{const t=new FormData;t.append("cafe_id",h.value),t.append("sale_type_id",S.value),t.append("receipt_type",y.value),t.append("services",JSON.stringify(s.value)),t.append("dni",e),t.append("date",f.value),t.append("double_price",l.value),E.post("./sales",t).then(o=>{o.data.dinner&&(p.value=o.data.dinner,g.value=o.data.dinner.subdealership,n("success",o.data.message||"Venta registrada exitosamente."),e.value=""),o.data.otherCafe&&_()}).catch(o=>{console.error("Error fetching dinners:",o),n("error",o),e.value=""})};return(e,t)=>(P(),O(V,null,[r(k(q),{title:"Comensales"}),r(H,null,{default:B(()=>[r(R,{showAlert:m.value,type:v.value,description:u.value},null,8,["showAlert","type","description"]),D("div",K,[r(z,{cafes:e.cafes,services:e.services,receipt_types:e.receipt_types,sale_types:e.sale_types,onShowServicesFromCafeSelected:A,onUpdateDate:U,onUpdateFormData:x},null,8,["cafes","services","receipt_types","sale_types"]),D("div",L,[r(j,{dinnerFound:p.value,subdealership:g.value,onHandleShowAlert:n,onShowDialog:_,onSaveSale:c,onUpdateDni:$,ref_key:"salesCardRef",ref:w},null,8,["dinnerFound","subdealership"]),r(T,{dinners:e.dinners,services:d.value,onAddServiceSelected:b},null,8,["dinners","services"]),r(G,{sales:e.sales},null,8,["sales"]),r(J,{showOtherUnitDialog:i.value,onHideDialog:C,onHandleDoublePriceSave:I},null,8,["showOtherUnitDialog"])])])]),_:1})],64))}});export{Ke as default};
